<!doctype html><html lang=en><head><meta charset=utf-8><meta content=public http-equiv=Cache-control><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,maximum-scale=5" name=viewport><title>Decrypt-Encrypt Functions From Command Line | OhDoyleRules</title><meta content="Decrypt-Encrypt Functions From Command Line | OhDoyleRules" name=twitter:title><meta content=KM-5h_iJ7JJsGeUp4ncEoYCBKft1ko1A4gBpjIzT0p4 name=google-site-verification><meta content="Decrypt-Encrypt Functions From Command Line" itemprop=name><meta content=OhDoyleRules property=og:site_name><meta content=https://ohdoylerules.com/snippets/openssl-encrypt-decrypt-functions/ itemprop=url><meta content=james2doyle@gmail.com itemprop=email><meta content=https://ohdoylerules.com/snippets/openssl-encrypt-decrypt-functions/ property=og:url><meta itemprop="image logo" content=/icons/logo.png><meta content=/icons/logo.png property=og:image><link href=/icons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/icons/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/icons/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link color=#333333 href=/icons/safari-pinned-tab.svg rel=mask-icon><link href=/icons/favicon.ico rel=icon sizes=any><link href=/icons/favicon.svg rel=icon type=image/svg+xml><meta content=/browserconfig.xml name=msapplication-config><meta content=#ffffff name=msapplication-TileColor><meta content=#ffffff name=theme-color><meta content=summary name=twitter:card><meta content=@james2doyle name=twitter:site><meta content="Decrypt-Encrypt Functions From Command Line" name=twitter:title><meta content=@james2doyle name=twitter:creator><meta content=/icons/logo.png name=twitter:image><meta content=/ name=twitter:domain><link href=/icons/logo.svg rel=icon><meta content="Functions to encrypt and then decrypt files from the command line with OpenSSL" name=description><meta content="Functions to encrypt and then decrypt files from the command line with OpenSSL" itemprop=description><meta content="Functions to encrypt and then decrypt files from the command line with OpenSSL" property=og:description><meta content="Functions to encrypt and then decrypt files from the command line with OpenSSL" name=twitter:description><link href=https://c.disquscdn.com rel=dns-prefetch><meta content=article property=og:type><meta content="Decrypt-Encrypt Functions From Command Line | OhDoyleRules" property=og:title><meta content="james2doyle@gmail.com James Doyle" property=article:author><meta content="encrypt, decrypt, openssl, cli, terminal, shell, command line, shred, rc4" itemprop=keywords><meta content="encrypt, decrypt, openssl, cli, terminal, shell, command line, shred, rc4" property=article:tag><meta content="encrypt, decrypt, openssl, cli, terminal, shell, command line, shred, rc4" property=og:keywords><link href=https://www.google-analytics.com rel=dns-prefetch><link rel="shortcut icon" href=/favicon.ico><link href=https://ohdoylerules.com/snippets/openssl-encrypt-decrypt-functions/ rel=canonical><link href=https://ohdoylerules.com/atom.xml rel=alternate title=atom type=application/atom+xml><style>body{font-feature-settings:'lnum' 1;font-variant-numeric:slashed-zero;text-rendering:geometricPrecision;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}.post-info{margin-bottom:1rem}a.none{color:inherit;border:none;opacity:1}a.none:hover {background:none;opacity:.6}.center{text-align:center}html.is-changing .transition-fade{view-transition-name:main}:view-transition-old(main){animation:fade .25s ease-in-out both}:view-transition-new(main){animation:fade .25s ease-in-out both reverse}@keyframes fade{from{opacity:1}to{opacity:0}}html.is-changing:not(.swup-native) .transition-fade {will-change:opacity;transition:.25s opacity;opacity:1}html.is-animating:not(.swup-native) .transition-fade {opacity:0}:root{--nc-font-sans:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--nc-font-mono:Consolas,monaco,'Ubuntu Mono','Liberation Mono','Courier New',Courier,monospace;--nc-tx-1:#fff;--nc-tx-2:#eee;--nc-bg-1:#000;--nc-bg-2:#111;--nc-bg-3:#222;--nc-lk-1:#3291ff;--nc-lk-2:#0070f3;--nc-lk-tx:#fff;--nc-ac-1:#7928ca;--nc-ac-tx:#fff}@media (prefers-color-scheme:dark){:root{--nc-tx-1:#fff;--nc-tx-2:#eee;--nc-bg-1:#000;--nc-bg-2:#111;--nc-bg-3:#222;--nc-lk-1:#3291ff;--nc-lk-2:#0070f3;--nc-lk-tx:#fff;--nc-ac-1:#7928ca;--nc-ac-tx:#fff}}*{margin:0;padding:0}address,area,article,aside,audio,blockquote,datalist,details,dl,fieldset,figure,form,iframe,img,input,meter,nav,ol,optgroup,option,output,p,pre,progress,ruby,section,table,textarea,ul,video{margin-bottom:1rem}button,html,input,select{font-family:var(--nc-font-sans)}body{margin:0 auto;max-width:750px;padding:2rem;border-radius:6px;overflow-x:hidden;word-break:break-word;overflow-wrap:break-word;background:var(--nc-bg-1);color:var(--nc-tx-2);font-size:1.03rem;line-height:1.5}:selection{background:var(--nc-ac-1);color:var(--nc-ac-tx)}h1,h2,h3,h4,h5,h6{line-height:1;color:var(--nc-tx-1);padding-top:.875rem}h1,h2,h3{color:var(--nc-tx-1);padding-bottom:2px;margin-bottom:8px;border-bottom:1px solid var(--nc-bg-2)}h4,h5,h6{margin-bottom:.3rem}h1{font-size:2.25rem}h2{font-size:1.85rem}h3{font-size:1.55rem}h4{font-size:1.25rem}h5{font-size:1rem}h6{font-size:.875rem}a{color:var(--nc-lk-1)}a:hover{color:var(--nc-lk-2)}abbr:hover{cursor:help}blockquote{padding:1.5rem;background:var(--nc-bg-2);border-left:5px solid var(--nc-bg-3)}abbr{cursor:help}blockquote:last-child{padding-bottom:0;margin-bottom:0}header{background:var(--nc-bg-2);border-bottom:1px solid var(--nc-bg-3);padding:2rem 1.5rem;margin:-2rem calc(0px - (50vw - 50%)) 2rem;padding-left:calc(50vw - 50%);padding-right:calc(50vw - 50%)}header h1,header h2,header h3{padding-bottom:0;border-bottom:0}header>:first-child{margin-top:0;padding-top:0}header>:last-child{margin-bottom:0}a button,button,input[type=button],input[type=reset],input[type=submit]{font-size:1rem;display:inline-block;padding:6px 12px;text-align:center;text-decoration:none;white-space:nowrap;background:var(--nc-lk-1);color:var(--nc-lk-tx);border:0;border-radius:4px;box-sizing:border-box;cursor:pointer}a button[disabled],button[disabled],input[type=button][disabled],input[type=reset][disabled],input[type=submit][disabled]{cursor:not-allowed;opacity:.5}.button:focus,.button:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{background:var(--nc-lk-2)}code,kbd,pre,samp{font-family:var(--nc-font-mono)}code,kbd,pre,samp{background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px;padding:3px 6px;font-size:.9rem}kbd{border-bottom:3px solid var(--nc-bg-3)}pre{padding:1rem 1.4rem;max-width:100%;overflow:auto}pre code{background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}code pre{display:inline;background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}details{padding:.6rem 1rem;background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px}summary{cursor:pointer;font-weight:700}details[open]{padding-bottom:.75rem}details[open] summary{margin-bottom:6px}details[open]>:last-child{margin-bottom:0}dt{font-weight:700}dd:before{content:'â†’ '}hr{border:0;border-bottom:1px solid var(--nc-bg-3);margin:1rem auto}fieldset{margin-top:1rem;padding:2rem;border:1px solid var(--nc-bg-3);border-radius:4px}legend{padding:auto .5rem}table{border-collapse:collapse;width:100%}td,th{border:1px solid var(--nc-bg-3);text-align:left;padding:.5rem}th{background:var(--nc-bg-2)}tr:nth-child(even){background:var(--nc-bg-2)}table caption{font-weight:700;margin-bottom:.5rem}textarea{max-width:100%}ol,ul{padding-left:2rem}li{margin-top:.4rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}mark{padding:3px 6px;background:var(--nc-ac-1);color:var(--nc-ac-tx)}input,select,textarea{padding:6px 12px;margin-bottom:.5rem;background:var(--nc-bg-2);color:var(--nc-tx-2);border:1px solid var(--nc-bg-3);border-radius:4px;box-shadow:none;box-sizing:border-box}img{max-width:100%}iframe{border:0;width:100%;height:100%;min-height:300px}</style><style>.center img{max-width:100%;height:auto}pre{color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre code.language-diff span:nth-child(1n + 7){color:#50fa7b}article blockquote p{margin-bottom:0}body table.highlight tr:nth-child(even){background-color:inherit}@media (prefers-color-scheme: dark){.gist-iframe{filter:invert(1) hue-rotate(180deg) brightness(1)}body table.highlight tr:nth-child(even){background-color:#f6f8fa}body table.highlight td,body table.highlight th{border-color:rgba(27,31,35,.3)}}</style><body><main class="container transition-fade" id=swup><div itemscope itemtype=http://schema.org/BlogPosting><div class=container><header class="grid center"><div class="cell menu"><h1 itemprop="name headline">Decrypt-Encrypt Functions From Command Line</h1></div></header><p><a title="Go Back Home" href=https://ohdoylerules.com>Go home</a><article class=the-loop><p class=post-info><span class=post-date itemprop=datePublished>ðŸ•’Â Â <span>November 22, 2013</span></span><div itemprop="ArticleBody text" class=main-content><h3 id=preamble>Preamble</h3><p>I have been reading about encryption and security since the whole NSA/Edward Snowden thing. It is pretty intense stuff. Most of the security comes from the philosophy of "security through obfuscation". What this means, is that you are making it extremely difficult (expensive, time-consuming) to try and look at your "stuff".<p>I would suggest reading <a rel="noopener nofollow noreferrer" href=http://en.wikipedia.org/wiki/Key_size target=_blank>this article on "Key Size"</a>. This is probably my favorite quote from the article:<blockquote><p>With a key of length <em>n</em> bits, there are <em>2n</em> possible keys. This number grows very rapidly as <em>n</em> increases. Moore's law suggests that computing power doubles roughly every 18 to 24 months, but even this doubling effect leaves the larger symmetric key lengths currently considered acceptable well out of reach.</blockquote><p>The best thing you can do for this type of encryption is <a rel="noopener nofollow noreferrer" href=https://tech.dropbox.com/2012/04/zxcvbn-realistic-password-strength-estimation/ target=_blank>pick a good password</a>.<h3 id=code>Code</h3><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#65737e># take in a file and output an encrypted one
</span><span style=color:#b48ead>function </span><span style=color:#8fa1b3>encrypt</span><span>() {
</span><span>  </span><span style=color:#65737e># take in a file and output a new one with a `.enc` extension
</span><span>  </span><span style=color:#bf616a>openssl</span><span> rc4</span><span style=color:#bf616a> -in </span><span>"$</span><span style=color:#bf616a>1</span><span>"</span><span style=color:#bf616a> -out </span><span>"$</span><span style=color:#bf616a>1</span><span>".enc
</span><span>  </span><span style=color:#96b5b4>echo </span><span>"$</span><span style=color:#bf616a>1</span><span style=color:#a3be8c>.enc created</span><span>"
</span><span>}
</span><span>
</span><span style=color:#65737e># reverse of encrypt()
</span><span style=color:#b48ead>function </span><span style=color:#8fa1b3>decrypt</span><span>() {
</span><span>  </span><span style=color:#bf616a>FILENAME</span><span>="$</span><span style=color:#bf616a>1</span><span>" </span><span style=color:#65737e># save the old filename
</span><span>  </span><span style=color:#65737e># decrypt the file and save it to a file with no `.enc` extension
</span><span>  </span><span style=color:#bf616a>openssl</span><span> rc4</span><span style=color:#bf616a> -d -in </span><span>"$</span><span style=color:#bf616a>1</span><span>"</span><span style=color:#bf616a> -out </span><span>${</span><span style=color:#bf616a>FILENAME</span><span>%.*}
</span><span>  </span><span style=color:#96b5b4>echo </span><span>"$</span><span style=color:#bf616a>1</span><span style=color:#a3be8c> decrypted</span><span>"
</span><span>}
</span></code></pre><p>This still leave an "open" file when the file is encrypted. Remember to remove the file securely. You can use <code>shred</code> or <code>gshred</code> (for OSX). Here is the info from the <code>--help</code> output of gshred:<blockquote><p>Overwrite the specified FILE(s) repeatedly, in order to make it harder for even very expensive hardware probing to recover the data.</blockquote><p>Here is the function that I found to be pretty good:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#65737e># overwrite 'my-unsafe-file.txt' 3 times, with zeros (nulls) and then remove the file
</span><span style=color:#bf616a>gshred --iterations</span><span>=3</span><span style=color:#bf616a> --zero --remove</span><span> my-unsafe-file.txt
</span></code></pre><p>Note: I used RC4 instead of 3DES because it is faster (95% slower than RC4), but it is not as secure.<h4 id=references>References:</h4><ul><li><a rel="noopener nofollow noreferrer" href=http://osxdaily.com/2012/01/30/encrypt-and-decrypt-files-with-openssl/ target=_blank>Encrypt & Decrypt Files from the Command Line with OpenSSL</a><li><a rel="noopener nofollow noreferrer" href=http://blog.commandlinekungfu.com/2009/05/episode-32-wiping-securely.html target=_blank>Wiping Securely</a><li><a rel="noopener nofollow noreferrer" href=http://zombe.es/post/4078724716/openssl-cipher-selection target=_blank>OpenSSL Cipher Selection</a></ul></div><p><a title="Go Back Home" href=https://ohdoylerules.com>Go home</a><hr><div class="media grid"><div class=media-left><a class=post-author-link href=https://twitter.com/james2doyle target=_blank> <img alt="James Doyle Profile Picture" src="https://www.gravatar.com/avatar/b7375c88e1864c4ddf0d7bdab58e4cca?s=120&d=mm&r=g" height=120 width=120> </a></div><div class="media-body cell -9of12"><div class=media-heading><h3 itemprop="author publisher creator provider">James Doyle</h3></div><div class=media-content><p>I'm a full-stack developer, co-organizer of <a title="PHP Vancouver" href=https://www.meetup.com/vancouver-php target=_blank>PHP Vancouver</a> meetup, and winner of a <a title="Canadian Developer 30 under 30 award" href=http://www.canadianbusiness.com/innovation/developer-30-under-30-gallery/image/20/ target=_blank>Canadian Developer 30 under 30 award</a>. I'm a huge Open Source advocate and contributor to a lot of projects in my community. When I am not sitting at a computer, I'm trying to perfect some other skill.</div></div></div></article></div></div></main><script src=https://unpkg.com/swup@4.6.1/dist/Swup.umd.js></script><script>const swup=new Swup({native:true});function handleGists(){const a=document.querySelectorAll('.iframes');[...a].forEach(function(b){b.onload=function(){b.style.height=b.contentWindow.document.body.scrollHeight+ 50+ 'px'};b.style.height=b.contentWindow.document.body.scrollHeight+ 50+ 'px'})}document.addEventListener('DOMContentLoaded',handleGists);swup.hooks.on('visit:end',handleGists,{priority:100})</script>