<!doctype html><html lang=en><head><meta charset=utf-8><meta content=public http-equiv=Cache-control><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,maximum-scale=5" name=viewport><title>Setup A Raspberry Pi with PHP And Lighttpd | OhDoyleRules</title><meta content="Setup A Raspberry Pi with PHP And Lighttpd | OhDoyleRules" name=twitter:title><meta content=KM-5h_iJ7JJsGeUp4ncEoYCBKft1ko1A4gBpjIzT0p4 name=google-site-verification><meta content="Setup A Raspberry Pi with PHP And Lighttpd" itemprop=name><meta content=OhDoyleRules property=og:site_name><meta content=https://ohdoylerules.com/snippets/raspberry-pi-php-and-lighttpd/ itemprop=url><meta content=james2doyle@gmail.com itemprop=email><meta content=https://ohdoylerules.com/snippets/raspberry-pi-php-and-lighttpd/ property=og:url><meta itemprop="image logo" content=/icons/logo.png><meta content=/icons/logo.png property=og:image><link href=/icons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/icons/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/icons/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/site.webmanifest rel=manifest><link color=#333333 href=/icons/safari-pinned-tab.svg rel=mask-icon><link href=/icons/favicon.ico rel=icon sizes=any><link href=/icons/favicon.svg rel=icon type=image/svg+xml><meta content=/browserconfig.xml name=msapplication-config><meta content=#ffffff name=msapplication-TileColor><meta content=#ffffff name=theme-color><meta content=summary name=twitter:card><meta content=@james2doyle name=twitter:site><meta content="Setup A Raspberry Pi with PHP And Lighttpd" name=twitter:title><meta content=@james2doyle name=twitter:creator><meta content=/icons/logo.png name=twitter:image><meta content=/ name=twitter:domain><link href=/icons/logo.svg rel=icon><meta content="Setup a raspberry pi with php 8.1 and the latest lighttpd web server" name=description><meta content="Setup a raspberry pi with php 8.1 and the latest lighttpd web server" itemprop=description><meta content="Setup a raspberry pi with php 8.1 and the latest lighttpd web server" property=og:description><meta content="Setup a raspberry pi with php 8.1 and the latest lighttpd web server" name=twitter:description><link href=https://c.disquscdn.com rel=dns-prefetch><meta content=article property=og:type><meta content="Setup A Raspberry Pi with PHP And Lighttpd | OhDoyleRules" property=og:title><meta content="james2doyle@gmail.com James Doyle" property=article:author><meta content="raspberry, pi, php, 8.1, composer, lighttpd, apache, web, server" itemprop=keywords><meta content="raspberry, pi, php, 8.1, composer, lighttpd, apache, web, server" property=article:tag><meta content="raspberry, pi, php, 8.1, composer, lighttpd, apache, web, server" property=og:keywords><link href=https://www.google-analytics.com rel=dns-prefetch><link rel="shortcut icon" href=/favicon.ico><link href=https://ohdoylerules.com/snippets/raspberry-pi-php-and-lighttpd/ rel=canonical><link href=https://ohdoylerules.com/atom.xml rel=alternate title=atom type=application/atom+xml><style>body{font-feature-settings:'lnum' 1;font-variant-numeric:slashed-zero;text-rendering:geometricPrecision;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}.post-info{margin-bottom:1rem}a.none{color:inherit;border:none;opacity:1}a.none:hover {background:none;opacity:.6}.center{text-align:center}html.is-changing .transition-fade{view-transition-name:main}:view-transition-old(main){animation:fade .25s ease-in-out both}:view-transition-new(main){animation:fade .25s ease-in-out both reverse}@keyframes fade{from{opacity:1}to{opacity:0}}html.is-changing:not(.swup-native) .transition-fade {will-change:opacity;transition:.25s opacity;opacity:1}html.is-animating:not(.swup-native) .transition-fade {opacity:0}:root{--nc-font-sans:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--nc-font-mono:Consolas,monaco,'Ubuntu Mono','Liberation Mono','Courier New',Courier,monospace;--nc-tx-1:#fff;--nc-tx-2:#eee;--nc-bg-1:#000;--nc-bg-2:#111;--nc-bg-3:#222;--nc-lk-1:#3291ff;--nc-lk-2:#0070f3;--nc-lk-tx:#fff;--nc-ac-1:#7928ca;--nc-ac-tx:#fff}@media (prefers-color-scheme:dark){:root{--nc-tx-1:#fff;--nc-tx-2:#eee;--nc-bg-1:#000;--nc-bg-2:#111;--nc-bg-3:#222;--nc-lk-1:#3291ff;--nc-lk-2:#0070f3;--nc-lk-tx:#fff;--nc-ac-1:#7928ca;--nc-ac-tx:#fff}}*{margin:0;padding:0}address,area,article,aside,audio,blockquote,datalist,details,dl,fieldset,figure,form,iframe,img,input,meter,nav,ol,optgroup,option,output,p,pre,progress,ruby,section,table,textarea,ul,video{margin-bottom:1rem}button,html,input,select{font-family:var(--nc-font-sans)}body{margin:0 auto;max-width:750px;padding:2rem;border-radius:6px;overflow-x:hidden;word-break:break-word;overflow-wrap:break-word;background:var(--nc-bg-1);color:var(--nc-tx-2);font-size:1.03rem;line-height:1.5}:selection{background:var(--nc-ac-1);color:var(--nc-ac-tx)}h1,h2,h3,h4,h5,h6{line-height:1;color:var(--nc-tx-1);padding-top:.875rem}h1,h2,h3{color:var(--nc-tx-1);padding-bottom:2px;margin-bottom:8px;border-bottom:1px solid var(--nc-bg-2)}h4,h5,h6{margin-bottom:.3rem}h1{font-size:2.25rem}h2{font-size:1.85rem}h3{font-size:1.55rem}h4{font-size:1.25rem}h5{font-size:1rem}h6{font-size:.875rem}a{color:var(--nc-lk-1)}a:hover{color:var(--nc-lk-2)}abbr:hover{cursor:help}blockquote{padding:1.5rem;background:var(--nc-bg-2);border-left:5px solid var(--nc-bg-3)}abbr{cursor:help}blockquote:last-child{padding-bottom:0;margin-bottom:0}header{background:var(--nc-bg-2);border-bottom:1px solid var(--nc-bg-3);padding:2rem 1.5rem;margin:-2rem calc(0px - (50vw - 50%)) 2rem;padding-left:calc(50vw - 50%);padding-right:calc(50vw - 50%)}header h1,header h2,header h3{padding-bottom:0;border-bottom:0}header>:first-child{margin-top:0;padding-top:0}header>:last-child{margin-bottom:0}a button,button,input[type=button],input[type=reset],input[type=submit]{font-size:1rem;display:inline-block;padding:6px 12px;text-align:center;text-decoration:none;white-space:nowrap;background:var(--nc-lk-1);color:var(--nc-lk-tx);border:0;border-radius:4px;box-sizing:border-box;cursor:pointer}a button[disabled],button[disabled],input[type=button][disabled],input[type=reset][disabled],input[type=submit][disabled]{cursor:not-allowed;opacity:.5}.button:focus,.button:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{background:var(--nc-lk-2)}code,kbd,pre,samp{font-family:var(--nc-font-mono)}code,kbd,pre,samp{background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px;padding:3px 6px;font-size:.9rem}kbd{border-bottom:3px solid var(--nc-bg-3)}pre{padding:1rem 1.4rem;max-width:100%;overflow:auto}pre code{background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}code pre{display:inline;background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}details{padding:.6rem 1rem;background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px}summary{cursor:pointer;font-weight:700}details[open]{padding-bottom:.75rem}details[open] summary{margin-bottom:6px}details[open]>:last-child{margin-bottom:0}dt{font-weight:700}dd:before{content:'â†’ '}hr{border:0;border-bottom:1px solid var(--nc-bg-3);margin:1rem auto}fieldset{margin-top:1rem;padding:2rem;border:1px solid var(--nc-bg-3);border-radius:4px}legend{padding:auto .5rem}table{border-collapse:collapse;width:100%}td,th{border:1px solid var(--nc-bg-3);text-align:left;padding:.5rem}th{background:var(--nc-bg-2)}tr:nth-child(even){background:var(--nc-bg-2)}table caption{font-weight:700;margin-bottom:.5rem}textarea{max-width:100%}ol,ul{padding-left:2rem}li{margin-top:.4rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}mark{padding:3px 6px;background:var(--nc-ac-1);color:var(--nc-ac-tx)}input,select,textarea{padding:6px 12px;margin-bottom:.5rem;background:var(--nc-bg-2);color:var(--nc-tx-2);border:1px solid var(--nc-bg-3);border-radius:4px;box-shadow:none;box-sizing:border-box}img{max-width:100%}iframe{border:0;width:100%;height:100%;min-height:300px}</style><style>.center img{max-width:100%;height:auto}pre{color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre code.language-diff span:nth-child(1n + 7){color:#50fa7b}article blockquote p{margin-bottom:0}body table.highlight tr:nth-child(even){background-color:inherit}@media (prefers-color-scheme: dark){.gist-iframe{filter:invert(1) hue-rotate(180deg) brightness(1)}body table.highlight tr:nth-child(even){background-color:#f6f8fa}body table.highlight td,body table.highlight th{border-color:rgba(27,31,35,.3)}}</style><body><main class="container transition-fade" id=swup><div itemscope itemtype=http://schema.org/BlogPosting><div class=container><header class="grid center"><div class="cell menu"><h1 itemprop="name headline">Setup A Raspberry Pi with PHP And Lighttpd</h1></div></header><p><a title="Go Back Home" href=https://ohdoylerules.com>Go home</a><article class=the-loop><p class=post-info><span class=post-date itemprop=datePublished>ðŸ•’Â Â <span>June 05, 2022</span></span><div itemprop="ArticleBody text" class=main-content><p>I recently got a Raspberry Pi model 4+. I'm using it to <a rel="noopener nofollow noreferrer" href=https://pimylifeup.com/raspberrypi-minidlna/ target=_blank>run a minidlna server</a> that loads music and movies from an old external hard drive that I have. On top of that, I wanted to run a local web server so that I can write scripts and pages that I can access locally on my network without having to have my laptop open and running.<p>I wanted to setup <code>lighttpd</code> as it is much more efficient than the default installed <code>apache2</code>. Since I'm already running <code>minidlna</code>, I wanted a web server that was more performant and used less memory/resources.<p>Finally, I wanted the latest PHP installed given I use it a lot in my day job and it will be great for writing small websites that are only ever accessed through my local network. Unfortunately, the default installed PHP version is quite a bit behind and you need to setup new sources in order to install the latest version of PHP.<p>Here is a short list of all the steps you need to setup a newer version of PHP 8.1 as well as the <code>lighttpd</code> server.<h4 id=instructions>Instructions</h4><p><em>These instructions assume you're using the default debian-based raspberry pi operating system!</em><p>Update the local packages already installed:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> apt-get update
</span></code></pre><p>Install the dependencies needed to add the additional services:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> apt-get install lsb-release apt-transport-https ca-certificates
</span></code></pre><p>Add the repository for installing the latest version of PHP:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> wget</span><span style=color:#bf616a> -O</span><span> /etc/apt/trusted.gpg.d/php.gpg https://origin.sury.org/php/apt.gpg
</span><span style=color:#96b5b4>echo </span><span>"</span><span style=color:#a3be8c>deb https://packages.sury.org/php/ </span><span>$</span><span style=color:#a3be8c>(</span><span style=color:#bf616a>lsb_release -sc</span><span style=color:#a3be8c>) main</span><span>" | </span><span style=color:#bf616a>sudo</span><span> tee /etc/apt/sources.list.d/php.list
</span></code></pre><p>Now we can install all the PHP packages we will need for basic PHP applications:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> apt-get update
</span><span style=color:#bf616a>sudo</span><span> apt-get install</span><span style=color:#bf616a> -y</span><span> php8.1 php8.1-cli php8.1-cgi php8.1-intl php8.1-zip
</span></code></pre><p>If you need additional PHP extensions then the above command is where you would add those in.<p>Since we now have the latest PHP version, we can setup <code>composer</code>. The <code>sha384</code> code may different for your installation based on whatever version is out when you are following these instructions. <a rel="noopener nofollow noreferrer" href=https://getcomposer.org/download/ target=_blank>You can find the latest download/install instructions on the Composer download page</a>.<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>php -r </span><span>"</span><span style=color:#a3be8c>copy('https://getcomposer.org/installer', 'composer-setup.php');</span><span>"
</span><span style=color:#bf616a>php -r </span><span>"</span><span style=color:#a3be8c>if (hash_file('sha384', 'composer-setup.php') === '55ce33d7678c5a611085589f1f3ddf8b3c52d662cd01d4ba75c0ee0459970c2200a51f492d557530c71c15d8dba01eae') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;</span><span>"
</span><span style=color:#bf616a>php</span><span> composer-setup.php
</span><span style=color:#bf616a>sudo</span><span> mv composer.phar /usr/local/bin/composer
</span><span style=color:#bf616a>php -r </span><span>"</span><span style=color:#a3be8c>unlink('composer-setup.php');</span><span>"
</span></code></pre><p>We can remove <code>apache2</code>, given we are not going to use it:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> systemctl stop apache2.service
</span><span style=color:#bf616a>sudo</span><span> apt remove apache2
</span></code></pre><p>The last thing to install will be <code>lighttpd</code>:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> apt-get install lighttpd lighttpd-doc
</span></code></pre><p>We also want to enable the PHP modules inside <code>lighttpd</code> so that we can process <code>.php</code> files:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> lighttpd-enable-mod fastcgi fastcgi-php
</span></code></pre><p>In order for the web server to properly run, serve our files, and store logs and caches, we need to make sure the folders have the right ownership rules:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> chown</span><span style=color:#bf616a> -R</span><span> www-data:www-data /var/log/lighttpd
</span><span style=color:#bf616a>sudo</span><span> chown</span><span style=color:#bf616a> -R</span><span> www-data:www-data /var/cache/lighttpd
</span><span style=color:#bf616a>sudo</span><span> chown</span><span style=color:#bf616a> -R</span><span> www-data:www-data /var/www/html
</span></code></pre><p>To test out the server once we are finished, we can setup this simple project that emulates the apache directory listing module. This will just list everything in our <code>/var/www/html</code> folder in a nice display:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>git</span><span> clone https://github.com/halgatewood/file-directory-list /var/www/html/listing
</span></code></pre><p>If you are looking for a more efficient directory browser, or you don't want to use PHP for this, you can <a rel="noopener nofollow noreferrer" href=https://redmine.lighttpd.net/projects/lighttpd/wiki/Docs_ModDirlisting target=_blank>use the built-in <code>dirlisting</code> module</a> that comes with <code>lighttpd</code>.<p>We can now make sure the <code>lighttpd</code> service is running so it will always start when we restart our pi:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sudo</span><span> systemctl start lighttpd.service
</span></code></pre><p>If you want to test the server on the command line, you can just <code>curl</code> your localhost and see what happens. You should get the source code for the listing page we installed:<pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>curl</span><span> http://localhost/listing
</span></code></pre><p>Done! That should be all you need to have PHP 8.1 and a light weight web server setup!</div><p><a title="Go Back Home" href=https://ohdoylerules.com>Go home</a><hr><div class="media grid"><div class=media-left><a class=post-author-link href=https://twitter.com/james2doyle target=_blank> <img alt="James Doyle Profile Picture" src="https://www.gravatar.com/avatar/b7375c88e1864c4ddf0d7bdab58e4cca?s=120&d=mm&r=g" height=120 width=120> </a></div><div class="media-body cell -9of12"><div class=media-heading><h3 itemprop="author publisher creator provider">James Doyle</h3></div><div class=media-content><p>I'm a full-stack developer, co-organizer of <a title="PHP Vancouver" href=https://www.meetup.com/vancouver-php target=_blank>PHP Vancouver</a> meetup, and winner of a <a title="Canadian Developer 30 under 30 award" href=http://www.canadianbusiness.com/innovation/developer-30-under-30-gallery/image/20/ target=_blank>Canadian Developer 30 under 30 award</a>. I'm a huge Open Source advocate and contributor to a lot of projects in my community. When I am not sitting at a computer, I'm trying to perfect some other skill.</div></div></div></article></div></div></main><script src=https://unpkg.com/swup@4.6.1/dist/Swup.umd.js></script><script>const swup=new Swup({native:true});function handleGists(){const a=document.querySelectorAll('.iframes');[...a].forEach(function(b){b.onload=function(){b.style.height=b.contentWindow.document.body.scrollHeight+ 50+ 'px'};b.style.height=b.contentWindow.document.body.scrollHeight+ 50+ 'px'})}document.addEventListener('DOMContentLoaded',handleGists);swup.hooks.on('visit:end',handleGists,{priority:100})</script>